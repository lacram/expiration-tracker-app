# Naver Clova OCR ì„¤ì • ê°€ì´ë“œ

ì´ ê°€ì´ë“œëŠ” Expiration Tracker ì•±ì—ì„œ Naver Clova OCR APIë¥¼ ì„¤ì •í•˜ëŠ” ë°©ë²•ì„ ì•ˆë‚´í•©ë‹ˆë‹¤.

---

## ğŸ“‹ ê°œìš”

Naver Clova OCRì€ ì´ë¯¸ì§€ì—ì„œ í…ìŠ¤íŠ¸ë¥¼ ì¸ì‹í•˜ëŠ” AI ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.
ì´ ì•±ì—ì„œëŠ” ê¸°í”„í‹°ì½˜ ì‚¬ì§„ì—ì„œ ë‹¤ìŒ ì •ë³´ë¥¼ ìë™ìœ¼ë¡œ ì¶”ì¶œí•©ë‹ˆë‹¤:
- ì¹´ë“œ ì´ë¦„
- ìœ íš¨ê¸°ê°„ (YYYY-MM-DD, YYYY.MM.DD, YYYYMMDD ë“±)
- ë°”ì½”ë“œ ë²ˆí˜¸ (10-15ìë¦¬)

---

## ğŸ”§ ì„¤ì • ë‹¨ê³„

### 1. Naver Cloud Platform ê³„ì • ìƒì„±

1. [Naver Cloud Platform](https://www.ncloud.com/) ì ‘ì†
2. **íšŒì›ê°€ì…** ë˜ëŠ” **ë¡œê·¸ì¸**
3. **ê²°ì œ ìˆ˜ë‹¨ ë“±ë¡** (ì‹ ìš©ì¹´ë“œ - ë¬´ë£Œ í‹°ì–´ ì‚¬ìš© ì‹œì—ë„ í•„ìš”)

### 2. Clova OCR ì„œë¹„ìŠ¤ í™œì„±í™”

1. Naver Cloud Platform ì½˜ì†” ë¡œê·¸ì¸
2. ì™¼ìª½ ë©”ë‰´ì—ì„œ **AIÂ·NAVER API** â†’ **Clova OCR** ì„ íƒ
3. **ì´ìš© ì‹ ì²­** ë²„íŠ¼ í´ë¦­
4. ì•½ê´€ ë™ì˜ í›„ **ì‹ ì²­** ì™„ë£Œ

### 3. API í‚¤ ë°œê¸‰

1. Clova OCR ì„œë¹„ìŠ¤ í˜ì´ì§€ì—ì„œ **ë„ë©”ì¸ ìƒì„±** í´ë¦­
2. ë„ë©”ì¸ ì •ë³´ ì…ë ¥:
   - **ë„ë©”ì¸ ì´ë¦„**: `expiration-tracker` (ì›í•˜ëŠ” ì´ë¦„)
   - **ì„œë¹„ìŠ¤ ìœ í˜•**: `General OCR` ì„ íƒ
   - **ì‚¬ìš© ëª©ì **: ê°œì¸ í”„ë¡œì íŠ¸ ë˜ëŠ” ìƒì—…ìš© ì„ íƒ
3. **ìƒì„±** ë²„íŠ¼ í´ë¦­

4. ìƒì„±ëœ ë„ë©”ì¸ í´ë¦­ â†’ **API í‚¤ ì •ë³´** í™•ì¸:
   - **Invoke URL**: OCR API ì—”ë“œí¬ì¸íŠ¸ (ë³µì‚¬)
   - **Secret Key**: API ì¸ì¦ í‚¤ (ë³µì‚¬)

### 4. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

#### ë¡œì»¬ ê°œë°œ í™˜ê²½ (application.yml)

`backend/src/main/resources/application.yml` íŒŒì¼ì„ ì—´ê³  ë‹¤ìŒ ì„¤ì •ì„ ì¶”ê°€í•©ë‹ˆë‹¤:

```yaml
naver:
  clova:
    ocr:
      url: https://YOUR_INVOKE_URL  # ë³µì‚¬í•œ Invoke URL
      secret: YOUR_SECRET_KEY        # ë³µì‚¬í•œ Secret Key
```

**ì˜ˆì‹œ:**
```yaml
naver:
  clova:
    ocr:
      url: https://abcdefg.apigw.ntruss.com/custom/v1/12345/general
      secret: YXBjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXo=
```

#### Railway í”„ë¡œë•ì…˜ í™˜ê²½

1. Railway í”„ë¡œì íŠ¸ í˜ì´ì§€ ì ‘ì†
2. **Variables** íƒ­ í´ë¦­
3. ë‹¤ìŒ í™˜ê²½ ë³€ìˆ˜ ì¶”ê°€:

| ë³€ìˆ˜ëª… | ê°’ |
|--------|-----|
| `NAVER_CLOVA_OCR_URL` | ë³µì‚¬í•œ Invoke URL |
| `NAVER_CLOVA_OCR_SECRET` | ë³µì‚¬í•œ Secret Key |

### 5. ì„¤ì • í™•ì¸

#### ë°±ì—”ë“œ ì„œë²„ ì¬ì‹œì‘

```powershell
cd C:\workspace\expiration-tracker-app\backend
.\gradlew.bat bootRun
```

ì„œë²„ ë¡œê·¸ì—ì„œ ë‹¤ìŒ ë©”ì‹œì§€ë¥¼ í™•ì¸:
```
...Naver Clova OCR API ì„¤ì • í™•ì¸...
```

#### API í…ŒìŠ¤íŠ¸

**PowerShell:**
```powershell
# Base64 ì¸ì½”ë”©ëœ ì´ë¯¸ì§€ë¡œ OCR í…ŒìŠ¤íŠ¸
$imageBase64 = "data:image/jpeg;base64,/9j/4AAQSkZJRg..." # ì‹¤ì œ Base64 ì´ë¯¸ì§€

$body = @{
    imageBase64 = $imageBase64
} | ConvertTo-Json

Invoke-RestMethod -Uri "http://localhost:8080/api/ocr/process" `
    -Method Post `
    -Body $body `
    -ContentType "application/json"
```

**ì˜ˆìƒ ì‘ë‹µ:**
```json
{
  "name": "ìŠ¤íƒ€ë²…ìŠ¤ ì•„ë©”ë¦¬ì¹´ë…¸",
  "expirationDate": "2025-12-31",
  "barcode": "1234567890123",
  "success": true,
  "message": "OCR ì„±ê³µ"
}
```

---

## ğŸ’° ìš”ê¸ˆ ì •ë³´

### ë¬´ë£Œ í‹°ì–´ (2024ë…„ ê¸°ì¤€)
- **ì›” 1,000ê±´** ë¬´ë£Œ OCR ìš”ì²­
- ì´ˆê³¼ ì‹œ: ê±´ë‹¹ ì•½ â‚©10

### ì˜ˆìƒ ë¹„ìš©
- ê°œì¸ ì‚¬ìš©: **ë¬´ë£Œ** (ì›” 1,000ê±´ ì´í•˜)
- ì¼ì¼ í‰ê·  30ê±´ ë“±ë¡ ì‹œ: **ë¬´ë£Œ** (30ê±´ Ã— 30ì¼ = 900ê±´)

**ì£¼ì˜**: ìµœì‹  ìš”ê¸ˆì€ [Naver Cloud Platform ìš”ê¸ˆ í˜ì´ì§€](https://www.ncloud.com/product/aiService/clovaOcr)ì—ì„œ í™•ì¸í•˜ì„¸ìš”.

---

## ğŸ§ª OCR ì •í™•ë„ ê°œì„  íŒ

### 1. ì´ë¯¸ì§€ í’ˆì§ˆ
- **í•´ìƒë„**: ìµœì†Œ 640Ã—480 ì´ìƒ ê¶Œì¥
- **ì¡°ëª…**: ë°ê³  ê· ì¼í•œ ì¡°ëª… (ê·¸ë¦¼ì ìµœì†Œí™”)
- **ê°ë„**: ì •ë©´ì—ì„œ ì´¬ì˜ (ê¸°ìš¸ì–´ì§€ì§€ ì•Šê²Œ)
- **ì´ˆì **: í…ìŠ¤íŠ¸ê°€ ì„ ëª…í•˜ê²Œ ë³´ì´ë„ë¡

### 2. ì´¬ì˜ ë°©ë²•
- ê¸°í”„í‹°ì½˜ ì „ì²´ê°€ í™”ë©´ì— ë“¤ì–´ì˜¤ë„ë¡
- ë°°ê²½ì€ ë‹¨ìƒ‰ìœ¼ë¡œ (í°ìƒ‰ ë˜ëŠ” ê²€ì€ìƒ‰ ì¶”ì²œ)
- ì†ê°€ë½ì´ë‚˜ ê·¸ë¦¼ìê°€ í…ìŠ¤íŠ¸ë¥¼ ê°€ë¦¬ì§€ ì•Šë„ë¡
- í”Œë˜ì‹œ ì‚¬ìš© ì‹œ ë°˜ì‚¬ ì£¼ì˜

### 3. ì¸ì‹ ê°€ëŠ¥í•œ í˜•ì‹
- **ë‚ ì§œ**:
  - âœ… `2025-12-31`
  - âœ… `2025.12.31`
  - âœ… `20251231`
  - âœ… `ìœ íš¨ê¸°ê°„: 2025-12-31`
  - âŒ `25/12/31` (2ìë¦¬ ì—°ë„ëŠ” ì¸ì‹ ë¶ˆê°€)

- **ë°”ì½”ë“œ**:
  - âœ… 10-15ìë¦¬ ì—°ì† ìˆ«ì
  - âœ… `1234567890123`
  - âŒ 9ìë¦¬ ì´í•˜ ë˜ëŠ” 16ìë¦¬ ì´ìƒ

---

## ğŸ› ë¬¸ì œ í•´ê²° (Troubleshooting)

### 1. "OCR APIê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤" ì˜¤ë¥˜

**ì›ì¸**: í™˜ê²½ ë³€ìˆ˜ê°€ ì„¤ì •ë˜ì§€ ì•ŠìŒ

**í•´ê²°**:
- `application.yml`ì— `naver.clova.ocr.url`ê³¼ `secret` ì¶”ê°€
- Railwayì˜ ê²½ìš° **Variables** íƒ­ì—ì„œ í™˜ê²½ ë³€ìˆ˜ í™•ì¸
- ì„œë²„ ì¬ì‹œì‘

### 2. "OCR ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤" ì˜¤ë¥˜

**ì›ì¸**:
- API í‚¤ê°€ ì˜ëª»ë¨
- Invoke URLì´ ì˜ëª»ë¨
- ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜
- API ì‚¬ìš©ëŸ‰ ì´ˆê³¼

**í•´ê²°**:
- Naver Cloud Platformì—ì„œ API í‚¤ ì¬í™•ì¸
- Invoke URLì´ ì •í™•í•œì§€ í™•ì¸
- API ì‚¬ìš©ëŸ‰ í™•ì¸ (ì›” 1,000ê±´ ì œí•œ)

### 3. OCR ì¸ì‹ ì‹¤íŒ¨ (success: false)

**ì›ì¸**: ì´ë¯¸ì§€ í’ˆì§ˆ ë¶ˆëŸ‰ ë˜ëŠ” í˜•ì‹ ë¶ˆì¼ì¹˜

**í•´ê²°**:
- ì´ë¯¸ì§€ë¥¼ ë” ë°ê³  ì„ ëª…í•˜ê²Œ ì´¬ì˜
- í…ìŠ¤íŠ¸ê°€ ì •ë©´ì—ì„œ ë³´ì´ë„ë¡ ì´¬ì˜
- ìˆ˜ë™ ì…ë ¥ìœ¼ë¡œ ëŒ€ì²´

### 4. ë°”ì½”ë“œ/ë‚ ì§œë§Œ ì¸ì‹ë˜ê³  ì´ë¦„ì€ ì•ˆ ë¨

**ì›ì¸**: ì´ë¦„ ì¶”ì¶œ ë¡œì§ì˜ í•œê³„

**í•´ê²°**:
- í˜„ì¬ëŠ” ì²« ë²ˆì§¸ í…ìŠ¤íŠ¸ ë¼ì¸ì„ ì´ë¦„ìœ¼ë¡œ ì¶”ì •
- OCR ì‘ë‹µ íŒŒì‹± ë¡œì§ ê°œì„  í•„ìš” (`OcrService.java:89-117`)
- ë˜ëŠ” ìˆ˜ë™ìœ¼ë¡œ ì´ë¦„ ì…ë ¥

---

## ğŸ” ê³ ê¸‰ ì„¤ì • (ì„ íƒ ì‚¬í•­)

### OCR íŒŒì‹± ë¡œì§ ì»¤ìŠ¤í„°ë§ˆì´ì§•

`backend/src/main/java/com/expirationtracker/service/OcrService.java` íŒŒì¼ì—ì„œ `parseOcrResponse` ë©”ì„œë“œë¥¼ ìˆ˜ì •í•˜ì—¬ OCR ì¸ì‹ ì •í™•ë„ë¥¼ ê°œì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ì˜ˆì‹œ**: íŠ¹ì • ë¸Œëœë“œ ì¸ì‹ ê°œì„ 
```java
private String extractCardName(String text) {
    // ìŠ¤íƒ€ë²…ìŠ¤, CU, GS25 ë“± íŠ¹ì • í‚¤ì›Œë“œ ìš°ì„  ê²€ìƒ‰
    String[] keywords = {"ìŠ¤íƒ€ë²…ìŠ¤", "CU", "GS25", "ì„¸ë¸ì¼ë ˆë¸", "íˆ¬ì¸í”Œë ˆì´ìŠ¤"};
    for (String keyword : keywords) {
        if (text.contains(keyword)) {
            // í‚¤ì›Œë“œê°€ í¬í•¨ëœ ë¼ì¸ ì¶”ì¶œ
            String[] lines = text.split("\\n");
            for (String line : lines) {
                if (line.contains(keyword)) {
                    return line.trim();
                }
            }
        }
    }

    // ê¸°ë³¸ ë¡œì§: ì²« ë²ˆì§¸ ë¼ì¸
    String[] lines = text.split("\\n");
    return lines.length > 0 ? lines[0].trim() : null;
}
```

---

## ğŸ“š ì°¸ê³  ìë£Œ

- [Naver Clova OCR ê³µì‹ ë¬¸ì„œ](https://api.ncloud-docs.com/docs/ai-naver-clovaocr)
- [Naver Cloud Platform ì½˜ì†”](https://console.ncloud.com/)
- [API ì‚¬ìš©ëŸ‰ í™•ì¸](https://console.ncloud.com/billing/cost)

---

## âœ… ì„¤ì • ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] Naver Cloud Platform ê³„ì • ìƒì„±
- [ ] Clova OCR ì„œë¹„ìŠ¤ í™œì„±í™”
- [ ] ë„ë©”ì¸ ìƒì„± ë° API í‚¤ ë°œê¸‰
- [ ] `application.yml`ì— í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
- [ ] ë°±ì—”ë“œ ì„œë²„ ì¬ì‹œì‘
- [ ] API í…ŒìŠ¤íŠ¸ (POST /api/ocr/process)
- [ ] Flutter ì•±ì—ì„œ OCR ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸

---

**ë¬¸ì„œ ë²„ì „**: 1.0
**ìµœì¢… ìˆ˜ì •**: 2025-10-30
**ì‘ì„±ì**: Claude (Anthropic)
